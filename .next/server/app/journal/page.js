(()=>{var e={};e.id=822,e.ids=[822],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},1645:e=>{"use strict";e.exports=require("net")},1997:e=>{"use strict";e.exports=require("punycode")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},4631:e=>{"use strict";e.exports=require("tls")},4735:e=>{"use strict";e.exports=require("events")},5511:e=>{"use strict";e.exports=require("crypto")},5591:e=>{"use strict";e.exports=require("https")},5908:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,pages:()=>d,routeModule:()=>c,tree:()=>u});var s=r(5239),a=r(8088),n=r(8170),i=r.n(n),o=r(893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let u={children:["",{children:["journal",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7848)),"C:\\santuary-App\\sanctuary-app-v3\\src\\app\\journal\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"C:\\santuary-App\\sanctuary-app-v3\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,4413)),"C:\\santuary-App\\sanctuary-app-v3\\src\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["C:\\santuary-App\\sanctuary-app-v3\\src\\app\\journal\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},c=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/journal/page",pathname:"/journal",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},7848:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\santuary-App\\\\sanctuary-app-v3\\\\src\\\\app\\\\journal\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\santuary-App\\sanctuary-app-v3\\src\\app\\journal\\page.tsx","default")},7910:e=>{"use strict";e.exports=require("stream")},8398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(687),a=r(3210),n=r(6189),i=r(8780),o=r(5362),l=r(2581),u=r(6464),d=r(1697);async function p(e,t){let r=(0,d.w)(t),{data:s,error:a}=await u.N.from("journal_comments").insert({entry_id:e,content:r}).select("*").single();if(a)throw a;if(!s)throw Error("Failed to insert comment.");return{...s,content:(0,d.Y)(s.content)}}function c({entryId:e}){let{user:t}=(0,i.A)(),[r,n]=(0,a.useState)([]),[o,u]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),x=async t=>{if(t.preventDefault(),o.trim()){c(!0);try{let t=await p(e,o.trim());n(e=>[...e,t]),u(""),l.o.success("Comment added")}catch{l.o.error("Failed to add comment")}finally{c(!1)}}};return(0,s.jsxs)("div",{className:"mt-1 space-y-1",children:[r.map(e=>(0,s.jsx)("div",{className:`text-sm ${e.user_id===t?.id?"text-right text-blue-600":"text-left text-gray-700"}`,children:e.content},e.id)),(0,s.jsxs)("form",{onSubmit:x,className:"flex space-x-2 mt-2",children:[(0,s.jsx)("input",{type:"text",className:"flex-1 border border-gray-300 rounded px-2 py-1 text-sm",placeholder:"Add comment...",value:o,onChange:e=>u(e.target.value),disabled:d}),(0,s.jsx)("button",{type:"submit",disabled:d||!o.trim(),className:"px-3 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50",children:d?"…":"Reply"})]})]})}function x(){let{user:e}=(0,i.A)();(0,n.useRouter)();let t=(0,n.useParams)().journalTitle,r=Array.isArray(t)?t[0]:t??"",[u,d]=(0,a.useState)([]),[p,x]=(0,a.useState)(""),[m,y]=(0,a.useState)(!1);if(!e||!t)return null;let f=async e=>{if(e.preventDefault(),p.trim()){y(!0);try{let e=await (0,o.R)(r,p.trim());d(t=>[...t,e]),x(""),l.o.success("Entry added")}catch(e){l.o.error(e instanceof Error?e.message:"Failed to add entry")}finally{y(!1)}}};return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("header",{className:"px-4 py-2 border-b flex items-center justify-between",children:(0,s.jsxs)("h1",{className:"text-xl font-semibold",children:["Journal: ",r]})}),(0,s.jsx)("main",{className:"flex-1 overflow-auto p-4 space-y-6",children:u.map(t=>(0,s.jsxs)("div",{className:`flex flex-col space-y-2 max-w-2xl mx-auto ${t.user_id===e.id?"items-end":"items-start"}`,children:[(0,s.jsx)("div",{className:`p-3 rounded-lg ${t.user_id===e.id?"bg-blue-100 text-blue-900":"bg-gray-100 text-gray-900"}`,children:t.content}),(0,s.jsx)(c,{entryId:t.id})]},t.id))}),(0,s.jsx)("footer",{className:"px-4 py-2 border-t",children:(0,s.jsxs)("form",{onSubmit:f,className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"Write a new entry…",value:p,onChange:e=>x(e.target.value),disabled:m,className:"flex-1 border border-gray-300 rounded px-3 py-2"}),(0,s.jsx)("button",{type:"submit",disabled:m||!p.trim(),className:"bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50",children:m?"Saving…":"Save"})]})})]})}},8933:(e,t,r)=>{Promise.resolve().then(r.bind(r,7848))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9205:(e,t,r)=>{Promise.resolve().then(r.bind(r,8398))},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[171,765,271],()=>r(5908));module.exports=s})();